<!DOCTYPE html>
<html lang="en">
    <meta charset="utf-8"/>
    <head>
        <script src="https://d3js.org/d3.v3.js"></script>
        <link rel="stylesheet" href="css/d3.slider.css" />
        <style>

         body {
             font-family: Verdana,Arial,sans-serif;
             max-width: 800px;
             margin: auto;
         }

         h2 {
    	       font-size: 1.2em;
    	       margin: 60px 0 5px 0;
         }

	       .wrapper div {
		         margin: 35px 0;
	       }

         .wrapper {
             width: 400px;
             margin-left: auto;
             margin-right: auto;
         }

         .d3-slider {
    	       width: 200px;
             margin: 20px;
             margin-bottom: 50px;
         }

         .axis path,
         .axis line {
             fill: none;
             stroke: #000;
             shape-rendering: crispEdges;
         }

         .dot {
             stroke: #000;
         }

         .tooltip {
             position: absolute;
             width: 200px;
             height: 28px;
             pointer-events: none;
         }

         .container-sliders {
             display: flex;
         }

         #container-inputs {
             border: solid 2px grey;
             padding: 10px 30px;
             border-radius: 5px;
             max-width: 800px;
         }

         #container-graph {

         }

         input {
             margin: 8px;
             font-size: 18px;
             padding: 10px;
             border-radius: 5px;
         }

         .coord_name {
             font-size: 20px;
             font-weight: bold;
             padding-left: 10px;
         }

         a:visited {
             color: blue;
         }

         .plot {

         }

         /* D3.JS */
         .axis-label {
             font-size: 20px;
         }
         #container-flex {
             display: flex;
         }

         #container-elevation-plot {
             float: right;
         }

         li {
             margin-bottom:  20px;
         }
         .first-sentence {
             line-height: 30px;
             }
        </style>
    </head>


    <body>
        <h1>Sun power</h1>
        <h2>Study of how much solar power reach the earth</h2>
        <p>The goal of this page is to compute the solar power available on Earth depending on the location and the time.
            The idea behing this is to see how solar panel are self-sufficient or not.</p>
        <p>So... What do we need to compute this ?
            <ol>
                <li><strong class="first-sentence">The solar flux before entering the atmosphere.</strong><br>
                    Thekaekara et al.(1976) found 1353 W/m<sup>2</sup>.</li>
                <li><strong class="first-sentence">The fraction of light remaining after going through the atmosphere.</strong><br>
                    It is a function of the quantity of atmosphere crossed.
                    One good approximation is:<br>
                    F = 1.1 * 0.7<sup>AM<sup>0.678</sup></sup><br>
                    where AM is the air mass. This unit measure the quantity of atmosphere but is normalized relatively to the quantity seen when the
                    light arrives with a perpendicular incidence (vertically).
                    <div class="plot" id="container-intensity-plot"></div>
                </li>
                <li><strong class="first-sentence">The relation between the angle of the incoming light and the air mass.</strong><br>
                    According to <a href="https://en.wikipedia.org/wiki/Air_mass_(solar_energy)" target="_blank">Wikipedia</a> the air mass can be described as:
                    AM = <span style="white-space: nowrap; font-size:larger">
                    &radic;<span style="text-decoration:overline;">&nbsp;(r<sup>2</sup> cos z) + 2r + 1&nbsp;</span>  - r cos z
                    </span><br>
                    where r is the ratio earth radius to athmosphere thickness
                    r=708
                    and z is the incidence angle with respect to the normal (0 degree is vertical)
                    <div class="plot" id="container-air-mass-plot"></div>
                </li>
            </ol>
        </p>
        <div id="container-inputs">
            <div class="plot" id="container-elevation-plot"></div>
            <div id="container-sliders">
                <div>
                    <div class="coord_name">Latitude: <span id="latitude-number"></span></div>
                    <div id="slider_latitude"></div>
                </div>

                <div>
                    <div class="coord_name">Longitude: <span id="longitude-number"></span></div>
                    <div id="slider_longitude"></div>
                </div>
            </div>

            <form>
                Date: <input type="date"  name="date" id="date" value="" style="margin-right:50px">
            </form>
            <form>
                Time zone offset to UTC: <input style="width:40px"type="number" step="0.5" name="utc-offset-number" id="utc-offset-number" value="0">
            </form>
            <p>You can compare the results with <a href="https://www.esrl.noaa.gov/gmd/grad/solcalc/azel.html" target="_blank">NOAA's solar position calculator</a></p>
        </div>
        <p>Integrated on the day, this makes a power of: <span id="daily-power"></span> joules per day per m<sup>2</sup>.</p>
        <script type="text/javascript" src="d3.slider.js" ></script>
        <script type="text/javascript" src="sun_motion.js" ></script>
        <script src="main.js"></script>
    </body>
</html>
